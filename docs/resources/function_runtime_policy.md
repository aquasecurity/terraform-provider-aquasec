---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "aquasec_function_runtime_policy Resource - terraform-provider-aquasec"
subcategory: ""
description: |-
  
---

# aquasec_function_runtime_policy (Resource)



## Example Usage

```terraform
# Example: Function Runtime Policy in Audit Mode 
resource "aquasec_function_runtime_policy" "audit_mode_example" {
  # Basic configuration
  name        = "function-policy-audit-mode"
  description = "Function runtime policy in audit mode for serverless functions"
  version     = "1.0"
  
  # Scope configuration
  scope {
    expression = "v1"
    variables {
      attribute = "function.name"
      value     = "*"
    }
  }
  
  # Application scope
  application_scopes = ["Global"]
  
  # Set to Audit mode (not enforcing)
  enabled = true
  enforce = false
  
  # Optional: Automatically switch to enforce mode after a period
  enforce_after_days = 14
  
  # Honeypot configuration (simplified to just use tripwire block)
  # tripwire {
  #   enabled        = true
  #   user_id        = "example_access_key"
  #   user_password  = "example_secret_key"
  #   apply_on       = ["Function"]
  #   serverless_app = "my-serverless-app" # Must be a real app in your environment
  # }
  
  # Block malicious activity
  executable_blacklist {
    enabled     = true
    executables = ["nc", "netcat", "wget", "curl", "bash"]
  }
  
  # Drift prevention
  drift_prevention {
    enabled               = true
    exec_lockdown         = true
    image_lockdown        = false
    exec_lockdown_white_list = ["authorized_process"]
  }
  
  # Malware scanning
  malware_scan_options {
    enabled             = true
    action              = "Alert"
    file_forensic_collection = true
    include_directories = ["/var/task", "/opt"]
    exclude_directories = ["/tmp", "/var/runtime"]
  }
  
  # File integrity monitoring
  file_integrity_monitoring {
    enabled                   = true
    monitored_files           = ["/etc/passwd", "/etc/shadow", "/var/task/index.js"]
    monitored_files_read      = true
    monitored_files_modify    = true
    monitored_files_attributes = true
    monitored_files_create    = true
    monitored_files_delete    = true
  }
  
  # Network security
  enable_crypto_mining_dns = false
  
  # Other security settings
  block_fileless_exec = false
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `name` (String) Name of the function runtime policy

### Optional

- `allowed_executables` (Block List) Allowed executables configuration. (see [below for nested schema](#nestedblock--allowed_executables))
- `application_scopes` (List of String) Indicates the application scope of the service.
- `block_disallowed_images` (Boolean) Block deployment from disallowed images.
- `block_fileless_exec` (Boolean) Block fileless execution attempts.
- `block_non_compliant_workloads` (Boolean) Block non-compliant serverless functions.
- `description` (String) The description of the function runtime policy
- `drift_prevention` (Block List) Drift prevention configuration for functions. (see [below for nested schema](#nestedblock--drift_prevention))
- `enable_crypto_mining_dns` (Boolean) Enable detection of crypto mining via DNS monitoring
- `enabled` (Boolean) Indicates if the runtime policy is enabled or not.
- `enforce` (Boolean) Indicates that policy should effect function execution (not just for audit).
- `enforce_after_days` (Number) Indicates the number of days after which the runtime policy will be changed to enforce mode.
- `exclude_application_scopes` (List of String) List of excluded application scopes.
- `executable_blacklist` (Block List) Executable blacklist configuration. (see [below for nested schema](#nestedblock--executable_blacklist))
- `file_integrity_monitoring` (Block List) Configuration for file integrity monitoring. (see [below for nested schema](#nestedblock--file_integrity_monitoring))
- `is_audit_checked` (Boolean) Indicates if audit check is enabled
- `is_auto_generated` (Boolean) Indicates if the policy was auto-generated
- `is_ootb_policy` (Boolean) Indicates if this is an out-of-the-box policy
- `malware_scan_options` (Block List, Max: 1) Configuration for Real-Time Malware Protection. (see [below for nested schema](#nestedblock--malware_scan_options))
- `runtime_type` (String) Type of runtime policy
- `scope` (Block List) Scope configuration. (see [below for nested schema](#nestedblock--scope))
- `scope_expression` (String) Logical expression of how to compute the dependency of the scope variables.
- `scope_variables` (Block List) List of scope attributes. (see [below for nested schema](#nestedblock--scope_variables))
- `tripwire` (Block List, Max: 1) Honeypot/tripwire configuration for detecting unauthorized access. (see [below for nested schema](#nestedblock--tripwire))
- `type` (String) Policy type identifier
- `version` (String) Version of the function runtime policy

### Read-Only

- `author` (String) Username of the account that created the policy
- `created` (String) Creation timestamp
- `id` (String) The ID of this resource.
- `lastupdate` (Number) Internal last update tracker
- `updated` (String) Last update timestamp

<a id="nestedblock--allowed_executables"></a>
### Nested Schema for `allowed_executables`

Optional:

- `allow_executables` (List of String) List of allowed executables.
- `allow_root_executables` (List of String) List of allowed root executables.
- `enabled` (Boolean) Whether allowed executables configuration is enabled.
- `separate_executables` (Boolean) Whether to treat executables separately.


<a id="nestedblock--drift_prevention"></a>
### Nested Schema for `drift_prevention`

Optional:

- `enabled` (Boolean) Whether drift prevention is enabled.
- `exec_lockdown` (Boolean) Whether to lockdown execution drift.
- `exec_lockdown_white_list` (List of String) List of items in the execution lockdown white list.
- `image_lockdown` (Boolean) Whether to lockdown image drift.


<a id="nestedblock--executable_blacklist"></a>
### Nested Schema for `executable_blacklist`

Optional:

- `enabled` (Boolean) Whether the executable blacklist is enabled.
- `executables` (List of String) List of blacklisted executables.


<a id="nestedblock--file_integrity_monitoring"></a>
### Nested Schema for `file_integrity_monitoring`

Optional:

- `enabled` (Boolean) If true, file integrity monitoring is enabled.
- `exceptional_monitored_files` (List of String) List of paths to be excluded from monitoring.
- `exceptional_monitored_files_processes` (List of String) List of processes to be excluded from monitoring.
- `exceptional_monitored_files_users` (List of String) List of users to be excluded from monitoring.
- `monitored_files` (List of String) List of paths to be monitored.
- `monitored_files_attributes` (Boolean) Whether to monitor file attribute operations.
- `monitored_files_create` (Boolean) Whether to monitor file create operations.
- `monitored_files_delete` (Boolean) Whether to monitor file delete operations.
- `monitored_files_modify` (Boolean) Whether to monitor file modify operations.
- `monitored_files_processes` (List of String) List of processes associated with monitored files.
- `monitored_files_read` (Boolean) Whether to monitor file read operations.
- `monitored_files_users` (List of String) List of users associated with monitored files.


<a id="nestedblock--malware_scan_options"></a>
### Nested Schema for `malware_scan_options`

Optional:

- `action` (String) Set Action, Defaults to 'Alert' when empty
- `enabled` (Boolean) Defines if malware scanning is enabled or not
- `exclude_directories` (List of String) List of directories to exclude from scanning.
- `exclude_processes` (List of String) List of processes to exclude from scanning.
- `include_directories` (List of String) List of directories to include in scanning.


<a id="nestedblock--scope"></a>
### Nested Schema for `scope`

Required:

- `expression` (String) Scope expression.
- `variables` (Block List, Min: 1) List of variables in the scope. (see [below for nested schema](#nestedblock--scope--variables))

<a id="nestedblock--scope--variables"></a>
### Nested Schema for `scope.variables`

Required:

- `attribute` (String) Variable attribute.
- `value` (String) Variable value.

Optional:

- `name` (String)



<a id="nestedblock--scope_variables"></a>
### Nested Schema for `scope_variables`

Required:

- `attribute` (String) Class of supported scope.
- `value` (String) Value assigned to the attribute.

Optional:

- `name` (String) Name assigned to the attribute.


<a id="nestedblock--tripwire"></a>
### Nested Schema for `tripwire`

Optional:

- `apply_on` (List of String) List of options to apply the honeypot on (Environment Variable, Layer, File)
- `enabled` (Boolean) Whether the honeypot is enabled.
- `serverless_app` (String) Serverless application name
- `user_id` (String) Honeypot User ID (Access Key)
- `user_password` (String, Sensitive) Honeypot User Password (Secret Key)


