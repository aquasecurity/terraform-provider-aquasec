---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "aquasec_container_runtime_policy Resource - terraform-provider-aquasec"
subcategory: ""
description: |-
  
---

# Resource `aquasec_container_runtime_policy`



## Example Usage

```terraform
resource "aquasec_container_runtime_policy" "container_runtime_policy" {
  name = "container_runtime_policy"
  description = "container_runtime_policy"
  enabled = true
  enforce = false
  block_container_exec          = true
  container_exec_allowed_processes = [
    "proc1",
    "proc2"
  ]
  block_cryptocurrency_mining = true
  block_fileless_exec = true
  block_non_compliant_images    = true
  block_non_compliant_workloads = true
  block_non_k8s_containers = true
  block_reverse_shell = true
  reverse_shell_allowed_processes = [
    "proc1",
    "proc2"
  ]
  reverse_shell_allowed_ips = [
    "ip1",
    "ip2"
  ]
  block_unregistered_images     = true
  blocked_capabilities = [
    "AUDIT_CONTROL",
    "AUDIT_WRITE"
  ]
  enable_ip_reputation_security = true
  enable_drift_prevention       = true
  allowed_executables = [
    "exe",
    "bin",
  ]
  blocked_executables = [
    "exe1",
    "exe2",
  ]
  blocked_files = [
    "test1",
    "test2"
  ]
  file_integrity_monitoring {
    monitor_create      = true
    monitor_read        = true
    monitor_modify      = true
    monitor_delete      = true
    monitor_attributes  = true
    monitored_paths     = ["paths"]
    excluded_paths      = ["expaths"]
    monitored_processes = ["process"]
    excluded_processes  = ["exprocess"]
    monitored_users     = ["user"]
    excluded_users      = ["expuser"]
  }
  audit_all_processes_activity  = true
  audit_full_command_arguments  = true
  audit_all_network_activity    = true
  enable_fork_guard             = true
  fork_guard_process_limit      = 13
  block_access_host_network     = true
  block_adding_capabilities     = true
  block_root_user               = true
  block_privileged_containers   = true
  block_use_ipc_namespace       = true
  block_use_pid_namespace       = true
  block_use_user_namespace      = true
  block_use_uts_namespace       = true
  block_low_port_binding        = true
  limit_new_privileges          = true
  blocked_packages = [
    "pkg",
    "pkg2"
  ]
  blocked_inbound_ports = [
    "80",
    "8080"
  ]
  blocked_outbound_ports = [
    "90",
    "9090"
  ]
  enable_port_scan_detection = true
  readonly_files_and_directories = [
    "readonly",
    "/dir/"
  ]
  exceptional_readonly_files_and_directories = [
    "readonly2",
    "/dir2/"
  ]
  allowed_registries = [
    "registry1",
    "registry2"
  ]
  monitor_system_time_changes = "true"
  blocked_volumes = [
    "blocked",
    "vol"
  ]
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- **name** (String) Name of the container runtime policy

### Optional

- **allowed_executables** (List of String) List of executables that are allowed for the user.
- **allowed_registries** (List of String) List of registries that allowed for running containers.
- **application_scopes** (List of String) Indicates the application scope of the service.
- **audit_all_network_activity** (Boolean) If true, all network activity will be audited.
- **audit_all_processes_activity** (Boolean) If true, all process activity will be audited.
- **audit_full_command_arguments** (Boolean) If true, full command arguments will be audited.
- **block_access_host_network** (Boolean) If true, prevent containers from running with access to host network.
- **block_adding_capabilities** (Boolean) If true, prevent containers from running with adding capabilities with `--cap-add` privilege.
- **block_container_exec** (Boolean) If true, exec into a container is prevented.
- **block_cryptocurrency_mining** (Boolean) Detect and prevent communication to DNS/IP addresses known to be used for Cryptocurrency Mining
- **block_fileless_exec** (Boolean) Detect and prevent running in-memory execution
- **block_low_port_binding** (Boolean) If true, prevent containers from running with the capability to bind in port lower than 1024.
- **block_non_compliant_images** (Boolean) If true, running non-compliant image in the container is prevented.
- **block_non_compliant_workloads** (Boolean) If true, running containers in non-compliant pods is prevented.
- **block_non_k8s_containers** (Boolean) If true, running non-kubernetes containers is prevented.
- **block_privileged_containers** (Boolean) If true, prevent containers from running with privileged container capability.
- **block_reverse_shell** (Boolean) If true, reverse shell is prevented.
- **block_root_user** (Boolean) If true, prevent containers from running with root user.
- **block_unregistered_images** (Boolean) If true, running images in the container that are not registered in Aqua is prevented.
- **block_use_ipc_namespace** (Boolean) If true, prevent containers from running with the privilege to use the IPC namespace.
- **block_use_pid_namespace** (Boolean) If true, prevent containers from running with the privilege to use the PID namespace.
- **block_use_user_namespace** (Boolean) If true, prevent containers from running with the privilege to use the user namespace.
- **block_use_uts_namespace** (Boolean) If true, prevent containers from running with the privilege to use the UTS namespace.
- **blocked_capabilities** (List of String) If true, prevents containers from using specific Unix capabilities.
- **blocked_executables** (List of String) List of executables that are prevented from running in containers.
- **blocked_files** (List of String) List of files that are prevented from being read, modified and executed in the containers.
- **blocked_inbound_ports** (List of String) List of blocked inbound ports.
- **blocked_outbound_ports** (List of String) List of blocked outbound ports.
- **blocked_packages** (List of String) Prevent containers from reading, writing, or executing all files in the list of packages.
- **blocked_volumes** (List of String) List of volumes that are prevented from being mounted in the containers.
- **container_exec_allowed_processes** (List of String) List of processes that will be allowed.
- **description** (String) The description of the container runtime policy
- **enable_drift_prevention** (Boolean) If true, executables that are not in the original image is prevented from running.
- **enable_fork_guard** (Boolean) If true, fork bombs are prevented in the containers.
- **enable_ip_reputation_security** (Boolean) If true, detect and prevent communication from containers to IP addresses known to have a bad reputation.
- **enable_port_scan_detection** (Boolean) If true, detects port scanning behavior in the container.
- **enabled** (Boolean) Indicates if the runtime policy is enabled or not.
- **enforce** (Boolean) Indicates that policy should effect container execution (not just for audit).
- **enforce_after_days** (Number) Indicates the number of days after which the runtime policy will be changed to enforce mode.
- **exceptional_readonly_files_and_directories** (List of String) List of files and directories to be excluded from the read-only list.
- **file_integrity_monitoring** (Block List, Max: 1) Configuration for file integrity monitoring. (see [below for nested schema](#nestedblock--file_integrity_monitoring))
- **fork_guard_process_limit** (Number) Process limit for the fork guard.
- **id** (String) The ID of this resource.
- **limit_new_privileges** (Boolean) If true, prevents the container from obtaining new privileges at runtime. (only enabled in enforce mode)
- **monitor_system_time_changes** (Boolean) If true, system time changes will be monitored.
- **readonly_files_and_directories** (List of String) List of files and directories to be restricted as read-only
- **reverse_shell_allowed_ips** (List of String) List of IPs/ CIDRs that will be allowed
- **reverse_shell_allowed_processes** (List of String) List of processes that will be allowed
- **scope_expression** (String) Logical expression of how to compute the dependency of the scope variables.
- **scope_variables** (Block List) List of scope attributes. (see [below for nested schema](#nestedblock--scope_variables))

### Read-only

- **author** (String) Username of the account that created the service.

<a id="nestedblock--file_integrity_monitoring"></a>
### Nested Schema for `file_integrity_monitoring`

Optional:

- **excluded_paths** (List of String) List of paths to be excluded from being monitored.
- **excluded_processes** (List of String) List of processes to be excluded from being monitored.
- **excluded_users** (List of String) List of users to be excluded from being monitored.
- **monitor_attributes** (Boolean) If true, add attributes operations will be monitored.
- **monitor_create** (Boolean) If true, create operations will be monitored.
- **monitor_delete** (Boolean) If true, deletion operations will be monitored.
- **monitor_modify** (Boolean) If true, modification operations will be monitored.
- **monitor_read** (Boolean) If true, read operations will be monitored.
- **monitored_paths** (List of String) List of paths to be monitored.
- **monitored_processes** (List of String) List of processes to be monitored.
- **monitored_users** (List of String) List of users to be monitored.


<a id="nestedblock--scope_variables"></a>
### Nested Schema for `scope_variables`

Required:

- **attribute** (String) Class of supported scope.
- **value** (String) Value assigned to the attribute.


