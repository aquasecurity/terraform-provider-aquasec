---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "aquasec_service Resource - terraform-provider-aquasec"
subcategory: ""
description: |-
  
---

# aquasec_service (Resource)



## Example Usage

```terraform
resource "aquasec_service" "example_service" {
  name               = "svc_example"
  description        = "Example service with global and local policies"
  target             = "container"
  priority           = 90
  application_scopes = ["Global"]
  enforce            = true

  // Global policies applied to this service
  policies = ["default", "policy1", "policy2"]

  // Local policy 1
  local_policies {
    name        = "policy1"
    type        = "access.control"
    description = "Local policy 1 for inbound and outbound control"

    inbound_networks {
      port_range    = "22/22"    # Allow SSH traffic
      resource_type = "anywhere" # Allow from any source
      allow         = true       # Permit traffic
    }

    outbound_networks {
      port_range    = "80/80"    # Allow HTTP traffic
      resource_type = "anywhere" # Allow to any destination
      allow         = true       # Permit traffic
    }

    block_metadata_service = false # Do not block metadata service
  }

  // Local policy 2
  local_policies {
    name        = "policy2"
    type        = "access.control"
    description = "Local policy 2 with stricter outbound control"

    inbound_networks {
      port_range    = "443/443"      # Allow HTTPS traffic
      resource_type = "custom"      # Allow from specific source
      resource      = "190.1.2.3/12" # Specific source
      allow         = true           # Permit traffic
    }

    outbound_networks {
      port_range    = "8080/8080" # Allow specific application traffic
      resource_type = "custom"      # Allow from specific source
      resource      = "190.1.2.3/12" # Specific source
      allow         = false       # Block traffic to unspecified destinations
    }

    block_metadata_service = true # Block metadata service access for security
  }
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `application_scopes` (List of String) Indicates the application scope of the service.
- `name` (String) The name of the service. It is recommended not to use whitespace characters in the name.
- `policies` (List of String) The service's policies; an array of container firewall policy names.
- `target` (String) Type of the workload. container or host.

### Optional

- `description` (String) A textual description of the service record; maximum 500 characters.
- `enforce` (Boolean) Enforcement status of the service.
- `local_policies` (Block List) A list of local policies for the service, including inbound and outbound network rules. (see [below for nested schema](#nestedblock--local_policies))
- `monitoring` (Boolean) Indicates if monitoring is enabled or not
- `priority` (Number) Rules priority, must be between 1-100.
- `scope_expression` (String) Logical expression of how to compute the dependency of the scope variables.
- `scope_variables` (Block List) List of scope attributes. (see [below for nested schema](#nestedblock--scope_variables))

### Read-Only

- `author` (String) Username of the account that created the service.
- `containers_count` (Number) The number of containers associated with the service.
- `evaluated` (Boolean) Whether the service has been evaluated for security vulnerabilities.
- `id` (String) The ID of this resource.
- `is_registered` (Boolean) Indicates if registered or not.
- `lastupdate` (Number) Timestamp of the last update in Unix time format.
- `not_evaluated_count` (Number) The number of container that are not evaluated.
- `unregistered_count` (Number) The number of containers allocated to the service that are not registered.
- `vulnerabilities_high` (Number) Number of high severity vulnerabilities.
- `vulnerabilities_low` (Number) Number of low severity vulnerabilities.
- `vulnerabilities_malware` (Number) Number of malware.
- `vulnerabilities_medium` (Number) Number of medium severity vulnerabilities.
- `vulnerabilities_negligible` (Number) Number of negligible vulnerabilities.
- `vulnerabilities_score_average` (Number) The CVSS average vulnerabilities score.
- `vulnerabilities_sensitive` (Number) Number of sensitive vulnerabilities.
- `vulnerabilities_total` (Number) Total number of vulnerabilities.

<a id="nestedblock--local_policies"></a>
### Nested Schema for `local_policies`

Required:

- `name` (String) The name of the local policy.
- `type` (String) The type of the local policy, e.g., access.control.

Optional:

- `block_metadata_service` (Boolean) Whether to block access to the metadata service.
- `description` (String) A description of the local policy.
- `inbound_networks` (Block List) Inbound network rules for the local policy. (see [below for nested schema](#nestedblock--local_policies--inbound_networks))
- `outbound_networks` (Block List) Outbound network rules for the local policy. (see [below for nested schema](#nestedblock--local_policies--outbound_networks))

<a id="nestedblock--local_policies--inbound_networks"></a>
### Nested Schema for `local_policies.inbound_networks`

Required:

- `allow` (Boolean) Whether the inbound network rule is allowed.
- `port_range` (String) The port range for the inbound network rule.
- `resource_type` (String) The resource type for the inbound network rule (e.g., anywhere).

Optional:

- `resource` (String) Custom ip for the inbound network rule (e.g., 190.1.2.3/12).


<a id="nestedblock--local_policies--outbound_networks"></a>
### Nested Schema for `local_policies.outbound_networks`

Required:

- `allow` (Boolean) Whether the outbound network rule is allowed.
- `port_range` (String) The port range for the outbound network rule.
- `resource_type` (String) The resource type for the outbound network rule (e.g., anywhere).

Optional:

- `resource` (String) Custom ip for the outbound network rule (e.g., 190.1.2.3/12).



<a id="nestedblock--scope_variables"></a>
### Nested Schema for `scope_variables`

Optional:

- `attribute` (String) Class of supported scope.
- `name` (String) Name assigned to the attribute.
- `value` (String) Value assigned to the attribute.


