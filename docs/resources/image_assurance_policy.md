---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "aquasec_image_assurance_policy Resource - terraform-provider-aquasec"
subcategory: ""
description: |-
  Aqua Image Assurance covers the first part of the container lifecycle: image development. The Image Assurance subsystem detects, assesses, and reports security issues in your images.
---

# aquasec_image_assurance_policy (Resource)

Aqua Image Assurance covers the first part of the container lifecycle: image development. The Image Assurance subsystem detects, assesses, and reports security issues in your images.

## Example Usage

```terraform
resource "aquasec_image_assurance_policy" "test_image_policy" {
  // Required values
  name               = "test_image_assurance_policy"
  application_scopes = ["Global"]

  // Below options default to true:
  block_failed     = true
  fail_cicd        = true
  audit_on_failure = true

  // Simple policy looking for critical vulnerabilites,
  // malware, and sensitive data
  cvss_severity         = "critical"
  cvss_severity_enabled = true
  disallow_malware      = true
  scan_sensitive_data   = true

}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `application_scopes` (List of String)
- `name` (String)

### Optional

- `aggregated_vulnerability` (Map of String) Aggregated vulnerability information.
- `allowed_images` (List of String) List of explicitly allowed images.
- `assurance_type` (String) What type of assurance policy is described.
- `audit_on_failure` (Boolean) Indicates if auditing for failures.
- `author` (String) Name of user account that created the policy.
- `auto_scan_configured` (Boolean)
- `auto_scan_enabled` (Boolean)
- `auto_scan_time` (Block Set) (see [below for nested schema](#nestedblock--auto_scan_time))
- `blacklist_permissions` (List of String) List of function's forbidden permissions.
- `blacklist_permissions_enabled` (Boolean) Indicates if blacklist permissions is relevant.
- `blacklisted_licenses` (List of String) List of blacklisted licenses.
- `blacklisted_licenses_enabled` (Boolean) Indicates if license blacklist is relevant.
- `block_failed` (Boolean) Indicates if failed images are blocked.
- `control_exclude_no_fix` (Boolean)
- `custom_checks` (Block List) List of Custom user scripts for checks. (see [below for nested schema](#nestedblock--custom_checks))
- `custom_checks_enabled` (Boolean) Indicates if scanning should include custom checks.
- `custom_severity` (String)
- `custom_severity_enabled` (Boolean)
- `cves_black_list` (List of String) List of cves blacklisted items.
- `cves_black_list_enabled` (Boolean) Indicates if CVEs blacklist is relevant.
- `cves_white_list` (List of String) List of cves whitelisted licenses
- `cves_white_list_enabled` (Boolean) Indicates if cves whitelist is relevant.
- `cvss_severity` (String) Identifier of the cvss severity.
- `cvss_severity_enabled` (Boolean) Indicates if the cvss severity is scanned.
- `cvss_severity_exclude_no_fix` (Boolean) Indicates that policy should ignore cvss cases that do not have a known fix.
- `description` (String)
- `disallow_exploit_types` (List of String)
- `disallow_malware` (Boolean) Indicates if malware should block the image.
- `docker_cis_enabled` (Boolean) Checks the host according to the Docker CIS benchmark, if Docker is found on the host.
- `domain` (String) Name of the container image.
- `domain_name` (String)
- `dta_enabled` (Boolean)
- `dta_severity` (String)
- `enabled` (Boolean)
- `enforce` (Boolean)
- `enforce_after_days` (Number)
- `enforce_excessive_permissions` (Boolean)
- `exceptional_monitored_malware_paths` (List of String)
- `exclude_application_scopes` (List of String)
- `fail_cicd` (Boolean) Indicates if cicd failures will fail the image.
- `forbidden_labels` (Block Set) (see [below for nested schema](#nestedblock--forbidden_labels))
- `forbidden_labels_enabled` (Boolean)
- `force_microenforcer` (Boolean)
- `function_integrity_enabled` (Boolean)
- `ignore_base_image_vln` (Boolean)
- `ignore_recently_published_vln` (Boolean)
- `ignore_recently_published_vln_period` (Number)
- `ignore_risk_resources_enabled` (Boolean) Indicates if risk resources are ignored.
- `ignored_risk_resources` (List of String) List of ignored risk resources.
- `ignored_sensitive_resources` (List of String)
- `images` (List of String) List of images.
- `kube_cis_enabled` (Boolean) Performs a Kubernetes CIS benchmark check for the host.
- `kubernetes_controls` (Block List, Max: 1) List of Kubernetes controls. (see [below for nested schema](#nestedblock--kubernetes_controls))
- `kubernetes_controls_avd_ids` (List of String)
- `kubernetes_controls_names` (List of String)
- `labels` (List of String) List of labels.
- `lastupdate` (String)
- `linux_cis_enabled` (Boolean)
- `malware_action` (String)
- `maximum_score` (Number) Value of allowed maximum score.
- `maximum_score_enabled` (Boolean) Indicates if exceeding the maximum score is scanned.
- `maximum_score_exclude_no_fix` (Boolean)
- `monitored_malware_paths` (List of String)
- `only_none_root_users` (Boolean) Indicates if raise a warning for images that should only be run as root.
- `openshift_hardening_enabled` (Boolean)
- `packages_black_list` (Block Set) List of blacklisted images. (see [below for nested schema](#nestedblock--packages_black_list))
- `packages_black_list_enabled` (Boolean) Indicates if packages blacklist is relevant.
- `packages_white_list` (Block Set) List of whitelisted images. (see [below for nested schema](#nestedblock--packages_white_list))
- `packages_white_list_enabled` (Boolean) Indicates if packages whitelist is relevant.
- `partial_results_image_fail` (Boolean)
- `permission` (String)
- `policy_settings` (Block List, Max: 1) (see [below for nested schema](#nestedblock--policy_settings))
- `read_only` (Boolean)
- `registries` (List of String) List of registries.
- `registry` (String)
- `required_labels` (Block Set) (see [below for nested schema](#nestedblock--required_labels))
- `required_labels_enabled` (Boolean)
- `scan_malware_in_archives` (Boolean)
- `scan_nfs_mounts` (Boolean)
- `scan_process_memory` (Boolean)
- `scan_sensitive_data` (Boolean) Indicates if scan should include sensitive data in the image.
- `scan_windows_registry` (Boolean)
- `scap_enabled` (Boolean) Indicates if scanning should include scap.
- `scap_files` (List of String) List of SCAP user scripts for checks.
- `scope` (Block Set) (see [below for nested schema](#nestedblock--scope))
- `trusted_base_images` (Block Set) List of trusted images. (see [below for nested schema](#nestedblock--trusted_base_images))
- `trusted_base_images_enabled` (Boolean) Indicates if list of trusted base images is relevant.
- `vulnerability_exploitability` (Boolean)
- `vulnerability_score_range` (List of Number)
- `whitelisted_licenses` (List of String) List of whitelisted licenses.
- `whitelisted_licenses_enabled` (Boolean) Indicates if license blacklist is relevant.

### Read-Only

- `id` (String) The ID of this resource.

<a id="nestedblock--auto_scan_time"></a>
### Nested Schema for `auto_scan_time`

Optional:

- `iteration` (Number)
- `iteration_type` (String)
- `time` (String)
- `week_days` (List of String)


<a id="nestedblock--custom_checks"></a>
### Nested Schema for `custom_checks`

Optional:

- `author` (String) Name of user account that created the policy.
- `description` (String)
- `engine` (String)
- `last_modified` (Number)
- `name` (String)
- `path` (String)
- `read_only` (Boolean)
- `script_id` (String)
- `severity` (String)
- `snippet` (String)


<a id="nestedblock--forbidden_labels"></a>
### Nested Schema for `forbidden_labels`

Optional:

- `key` (String)
- `value` (String)


<a id="nestedblock--kubernetes_controls"></a>
### Nested Schema for `kubernetes_controls`

Optional:

- `avd_id` (String)
- `description` (String)
- `enabled` (Boolean)
- `kind` (String)
- `name` (String)
- `ootb` (Boolean)
- `script_id` (Number)
- `severity` (String)


<a id="nestedblock--packages_black_list"></a>
### Nested Schema for `packages_black_list`

Optional:

- `arch` (String)
- `display` (String)
- `epoch` (String)
- `format` (String)
- `license` (String)
- `name` (String)
- `release` (String)
- `version` (String)
- `version_range` (String)


<a id="nestedblock--packages_white_list"></a>
### Nested Schema for `packages_white_list`

Optional:

- `arch` (String)
- `display` (String)
- `epoch` (String)
- `format` (String)
- `license` (String)
- `name` (String)
- `release` (String)
- `version` (String)
- `version_range` (String)


<a id="nestedblock--policy_settings"></a>
### Nested Schema for `policy_settings`

Optional:

- `enforce` (Boolean)
- `is_audit_checked` (Boolean)
- `warn` (Boolean)
- `warning_message` (String)


<a id="nestedblock--required_labels"></a>
### Nested Schema for `required_labels`

Optional:

- `key` (String)
- `value` (String)


<a id="nestedblock--scope"></a>
### Nested Schema for `scope`

Optional:

- `expression` (String)
- `variables` (Block List) (see [below for nested schema](#nestedblock--scope--variables))

<a id="nestedblock--scope--variables"></a>
### Nested Schema for `scope.variables`

Optional:

- `attribute` (String)
- `name` (String)
- `value` (String)



<a id="nestedblock--trusted_base_images"></a>
### Nested Schema for `trusted_base_images`

Optional:

- `imagename` (String)
- `registry` (String)


